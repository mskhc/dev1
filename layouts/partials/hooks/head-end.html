<link rel="manifest" href="/manifest.webmanifest">
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "url": "https://kubernetes.io",
    "logo": "https://kubernetes.io/images/favicon.png",
{{- if not .Site.Params.deprecated }}
    "potentialAction": {
      "@type": "SearchAction",
      "target": {{ printf "%s%s" ("search/" | absURL) "?q={search_term_string}" }},
      "query-input": "required name=search_term_string"
    }
{{ end }}
  }
</script>

<meta name="theme-color" content="#326ce5">

{{- if or (.HasShortcode "table")  (.HasShortcode "feature-gate-table") -}}
  {{- if hugo.IsProduction -}}
    {{- $sortableTableJs :=  resources.Get "js/sortable-table.js" | minify | fingerprint -}}
<script defer src="{{ $sortableTableJs.RelPermalink }}" integrity="{{ $sortableTableJs.Data.Integrity }}" crossorigin="anonymous"></script>
  {{- else -}}
    {{- $sortableTableJs := resources.Get "js/sortable-table.js" -}}
<script defer src="{{ $sortableTableJs.RelPermalink }}"></script>
  {{- end -}}
{{- end -}}

{{- if .HasShortcode "cncf-landscape" -}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.9/iframeResizer.min.js" integrity="sha384-hHTwgxzjpO1G1NI0wMHWQYUxnGtpWyDjVSZrFnDrlWa5OL+DFY57qnDWw/5WSJOl" crossorigin="anonymous"></script>
{{- end -}}

{{- if .HasShortcode "figure" -}}
<!-- Enable zoom-on-click for figures that opt in to this -->
  {{- if hugo.IsProduction -}}
    {{- $zoomJs :=  resources.Get "js/zoom.js" | minify | fingerprint -}}
<script defer src="{{ $zoomJs.RelPermalink }}" integrity="{{ $zoomJs.Data.Integrity }}" crossorigin="anonymous"></script>
  {{- else -}}
    {{- $zoomJs := resources.Get "js/zoom.js" -}}
<script defer src="{{ $zoomJs.RelPermalink }}"></script>
  {{- end -}}
{{- end -}}

{{ if .HasShortcode "mermaid" }}
  <!-- Copied from https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js -->
  {{- with resources.Get "js/mermaid-10.6.1.min.js" -}}
  <script src="{{ .RelPermalink }}" integrity="sha384-+NGfjU8KzpDLXRHduEqW+ZiJr2rIg+cidUVk7B51R5xK7cHwMKQfrdFwGdrq1Bcz"></script>
  {{- else -}}
    <!-- without Mermaid, the site won't appear right -->
    {{- errorf "No Mermaid helper script found" -}}
  {{- end -}}
{{- end -}}

{{- if .HasShortcode "release-binaries" -}}
  {{- if hugo.IsProduction -}}
    {{- $releaseBinariesJs :=  resources.Get "js/release_binaries.js" | minify | fingerprint -}}
<script defer src="{{ $releaseBinariesJs.RelPermalink }}" integrity="{{ $releaseBinariesJs.Data.Integrity }}" crossorigin="anonymous"></script>
  {{- else -}}
    {{- $releaseBinariesJs := resources.Get "js/release_binaries.js" -}}
<script defer src="{{ $releaseBinariesJs.RelPermalink }}"></script>
  {{- end -}}
{{- end -}}

{{- if eq .Layout "glossary" -}}
  {{- with resources.Get "js/glossary.js" -}}
  <script defer src="{{ .RelPermalink }}"></script>
  {{- else -}}
    {{- errorf "Unable to find the glossary helper script" -}}
  {{- end -}}
  {{- with resources.Get "css/glossary.css" -}}
    <link href="{{ .RelPermalink }}" rel="stylesheet">
  {{- end -}}
{{- end -}}

{{- if eq (lower .Params.cid) "community" -}}
<script defer src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
{{- end -}}

{{- if eq .Layout "search" -}}
  {{- $searchJs :=  resources.Get "js/search.js" | minify | fingerprint -}}
<script src="{{ $searchJs.RelPermalink }}" integrity="{{ $searchJs.Data.Integrity }}" crossorigin="anonymous"></script>
{{- end -}}

<!-- Content for social media sharing previews -->
<!-- Facebook uses the og: stuff, while Twitter and others use twitter: -->
<meta name="description" content="{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Summary }}{{ end }}">
<meta property="og:description" content="{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Summary }}{{ end }}">
<meta name="twitter:description" content="{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Summary }}{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:title" content="{{ if .Params.title }}{{ .Title }}{{ else }}{{ .Summary | truncate 10 }}{{ end }}">
<meta name="twitter:title" content="{{ if .Params.title }}{{ .Title }}{{ else }}{{ .Summary | truncate 10 }}{{ end }}">
<meta name="twitter:image" content="https://kubernetes.io/images/favicon.png" />
<!-- Alt text for the site image -->
<meta name="twitter:image:alt" content="{{ site.Title }}">
{{- if ( eq .Section "blog" ) -}}
{{ with findRE "<img.*?>" .Content 1 }}
<meta property="og:image" content="{{ index . 0 | replaceRE ".*src=\"(.+?)\".*" "$1" }}">
{{ end }}
<meta property="og:type" content="article">
{{ else }}
<meta property="og:image" content="{{ "/images/kubernetes-horizontal-color.png" | relURL }}">
<meta property="og:type" content="website">
{{ end }}
