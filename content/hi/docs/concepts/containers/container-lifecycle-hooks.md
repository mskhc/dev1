---
title: कंटेनर जीवनचक्र हुक
content_type: concept
weight: 40
---

<!-- overview -->

यह पृष्ठ बताता है कि कैसे क्यूबलेट प्रबंधित कंटेनर अपने प्रबंधन जीवनचक्र के दौरान घटनाओं द्वारा ट्रिगर किए गए कोड को चलाने के लिए कंटेनर जीवनचक्र हुक फ्रेमवर्क का उपयोग कर सकते हैं।

<!-- body -->

## अवलोकन

कई प्रोग्रामिंग भाषा फ्रेमवर्क के समान, जिनमें घटक जीवनचक्र हुक होते हैं, जैसे कि Angular, Kubernetes कंटेनर को जीवनचक्र हुक प्रदान करता है।
हुक कंटेनर को उनके प्रबंधन जीवनचक्र में घटनाओं के बारे में जागरूक करने और संबंधित जीवनचक्र हुक के निष्पादित होने पर हैंडलर में कार्यान्वित कोड चलाने में सक्षम बनाता है।

## कंटेनर हुक

दो हुक हैं जो कंटेनर के संपर्क में आते हैं:

`PostStart`

यह हुक कंटेनर बनने के तुरंत बाद निष्पादित होता है।
हालाँकि, इस बात की कोई गारंटी नहीं है कि हुक कंटेनर ENTRYPOINT से पहले निष्पादित होगा।
हैंडलर को कोई पैरामीटर पास नहीं किया जाता है।

`PreStop`

यह हुक API अनुरोध या प्रबंधन ईवेंट जैसे कि लाइवनेस/स्टार्टअप जांच विफलता, प्रीएम्पशन, संसाधन विवाद और अन्य के कारण कंटेनर के समाप्त होने से तुरंत पहले कॉल किया जाता है। यदि कंटेनर पहले से ही समाप्त या पूर्ण स्थिति में है, तो `PreStop` हुक पर कॉल विफल हो जाता है और कंटेनर को रोकने के लिए TERM सिग्नल भेजे जाने से पहले हुक को पूरा होना चाहिए। पॉड की समाप्ति अनुग्रह अवधि की उलटी गिनती `PreStop` हुक के निष्पादित होने से पहले शुरू होती है, इसलिए हैंडलर के परिणाम की परवाह किए बिना, कंटेनर अंततः पॉड की समाप्ति अनुग्रह अवधि के भीतर समाप्त हो जाएगा। हैंडलर को कोई पैरामीटर पास नहीं किया जाता है।

समाप्ति व्यवहार का अधिक विस्तृत विवरण [पॉड्स की समाप्ति](/docs/concepts/workloads/pods/pod-lifecycle/#pod-termination) पेज में पाया जा सकता है।

### हुक हैंडलर कार्यान्वयन

कंटेनर उस हुक के लिए हैंडलर को कार्यान्वित और पंजीकृत करके हुक तक पहुँच सकते हैं।
कंटेनर के लिए तीन प्रकार के हुक हैंडलर कार्यान्वित किए जा सकते हैं:

* Exec - कंटेनर के cgroups और नामस्थानों के अंदर `pre-stop.sh` जैसे विशिष्ट कमांड को निष्पादित करता है।
कमांड द्वारा उपभोग किए गए संसाधनों को कंटेनर के विरुद्ध गिना जाता है।
* HTTP - कंटेनर पर एक विशिष्ट एंडपॉइंट के विरुद्ध HTTP अनुरोध निष्पादित करता है।
* स्लीप - कंटेनर को निर्दिष्ट अवधि के लिए रोक देता है।
यह `PodLifecycleSleepAction` [फीचर गेट](/docs/reference/command-line-tools-reference/feature-gates/) द्वारा सक्षम एक बीटा-स्तरीय सुविधा डिफ़ॉल्ट है।

### हुक हैंडलर निष्पादन

जब कंटेनर जीवनचक्र प्रबंधन हुक को कॉल किया जाता है, तो कुबेरनेट्स प्रबंधन प्रणाली हुक क्रिया के अनुसार हैंडलर को निष्पादित करती है, `httpGet`, `tcpSocket` और `sleep` को क्यूबलेट प्रक्रिया द्वारा निष्पादित किया जाता है, और `exec` को कंटेनर में निष्पादित किया जाता है।

`PostStart` हुक हैंडलर कॉल तब शुरू होता है जब कंटेनर बनाया जाता है, जिसका अर्थ है कि कंटेनर ENTRYPOINT और `PostStart` हुक एक साथ ट्रिगर होते हैं।

हालाँकि, यदि `PostStart` हुक को निष्पादित होने में बहुत अधिक समय लगता है या यदि यह लटकता है, तो यह कंटेनर को `रनिंग` स्थिति में जाने से रोक सकता है।

`PreStop` हुक को कंटेनर को रोकने के लिए सिग्नल से एसिंक्रोनस रूप से निष्पादित नहीं किया जाता है; हुक को TERM सिग्नल भेजे जाने से पहले अपना निष्पादन पूरा करना होगा। यदि निष्पादन के दौरान `PreStop` हुक लटका रहता है, तो पॉड का चरण `Termination` होगा और तब तक वहीं रहेगा जब तक कि पॉड को उसके `terminationGracePeriodSeconds` के समाप्त होने के बाद मार नहीं दिया जाता। यह ग्रेस पीरियड `PreStop` हुक को निष्पादित करने और कंटेनर को सामान्य रूप से रोकने में लगने वाले कुल समय पर लागू होता है। यदि, उदाहरण के लिए, `terminationGracePeriodSeconds` 60 है, और हुक को पूरा होने में 55 सेकंड लगते हैं, और कंटेनर को सिग्नल प्राप्त करने के बाद सामान्य रूप से रुकने में 10 सेकंड लगते हैं, तो कंटेनर को सामान्य रूप से रुकने से पहले ही मार दिया जाएगा, क्योंकि endingGracePeriodSeconds` इन दोनों चीजों को होने में लगने वाले कुल समय (55+10) से कम है।

यदि `PostStart` या `PreStop` हुक विफल हो जाता है, तो यह कंटेनर को मार देता है।

उपयोगकर्ताओं को अपने हुक हैंडलर को यथासंभव हल्का बनाना चाहिए।
हालांकि, ऐसे मामले भी हैं, जब लंबे समय तक चलने वाले कमांड समझ में आते हैं, जैसे कि कंटेनर को रोकने से पहले स्टेट को सहेजना।

### हुक डिलीवरी की गारंटी

हुक डिलीवरी का उद्देश्य *कम से कम एक बार* होना है,
जिसका मतलब है कि किसी भी दिए गए इवेंट के लिए हुक को कई बार कॉल किया जा सकता है, जैसे कि `PostStart` या `PreStop` के लिए। इसे सही तरीके से हैंडल करना हुक कार्यान्वयन पर निर्भर करता है।

आम तौर पर, केवल सिंगल डिलीवरी की जाती है।
अगर, उदाहरण के लिए, HTTP हुक रिसीवर डाउन है और ट्रैफ़िक लेने में असमर्थ है, तो फिर से भेजने का कोई प्रयास नहीं किया जाता है। हालाँकि, कुछ दुर्लभ मामलों में, डबल डिलीवरी हो सकती है।
उदाहरण के लिए, अगर हुक भेजने के बीच में क्यूबलेट फिर से चालू हो जाता है,
तो क्यूबलेट के वापस आने के बाद हुक को फिर से भेजा जा सकता है।

### हुक हैंडलर को डीबग करना

पॉड इवेंट में हुक हैंडलर के लिए लॉग प्रदर्शित नहीं किए जाते हैं।
अगर किसी कारण से हैंडलर विफल हो जाता है, तो यह एक इवेंट प्रसारित करता है।
`PostStart` के लिए, यह `FailedPostStartHook` इवेंट है, और `PreStop` के लिए, यह `FailedPreStopHook` इवेंट है।
खुद एक विफल `FailedPostStartHook` इवेंट जनरेट करने के लिए, postStart कमांड को "badcommand" में बदलने के लिए [lifecycle-events.yaml](https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/lifecycle-events.yaml) फ़ाइल को संशोधित करें और इसे लागू करें।
`kubectl describe pod lifecycle-demo` चलाने से आपको दिखाई देने वाले परिणामी इवेंट का कुछ उदाहरण आउटपुट यहां दिया गया है:

```
Events:
  Type     Reason               Age              From               Message
  ----     ------               ----             ----               -------
  Normal   Scheduled            7s               default-scheduler  Successfully assigned default/lifecycle-demo to ip-XXX-XXX-XX-XX.us-east-2...
  Normal   Pulled               6s               kubelet            Successfully pulled image "nginx" in 229.604315ms
  Normal   Pulling              4s (x2 over 6s)  kubelet            Pulling image "nginx"
  Normal   Created              4s (x2 over 5s)  kubelet            Created container lifecycle-demo-container
  Normal   Started              4s (x2 over 5s)  kubelet            Started container lifecycle-demo-container
  Warning  FailedPostStartHook  4s (x2 over 5s)  kubelet            Exec lifecycle hook ([badcommand]) for Container "lifecycle-demo-container" in Pod "lifecycle-demo_default(30229739-9651-4e5a-9a32-a8f1688862db)" failed - error: command 'badcommand' exited with 126: , message: "OCI runtime exec failed: exec failed: container_linux.go:380: starting container process caused: exec: \"badcommand\": executable file not found in $PATH: unknown\r\n"
  Normal   Killing              4s (x2 over 5s)  kubelet            FailedPostStartHook
  Normal   Pulled               4s               kubelet            Successfully pulled image "nginx" in 215.66395ms
  Warning  BackOff              2s (x2 over 3s)  kubelet            Back-off restarting failed container
```



## {{% heading "whatsnext" %}}

* [कंटेनर वातावरण](/hi/docs/concepts/containers/container-environment/) के बारे में अधिक जानें।
* [कंटेनर जीवनचक्र ईवेंट](/docs/tasks/configure-pod-container/attach-handler-lifecycle-event/) में हैंडलर संलग्न करने का व्यावहारिक अनुभव प्राप्त करें।

